---
title: "Assignment 3"
author: "Tanjina Islam, Miguel Morales Expósito and Carlos Perales Liñan, group 12"
date: "13 March 2018"
output:
  pdf_document:
    fig_caption: yes
fontsize: 11pt
highlight: tango
---
```{r,echo=FALSE}
options(digits = 3) #Showing only 3 decimals
```

## Exercise 1
We load the data from the data source
```{r}
bread = read.table("bread.txt", header=TRUE)
attach(bread)
```

### Task 1 MISSING!

```{r}
# Add Code
```

### Task 2

```{r}
boxplot(hours~environment,data=bread)
boxplot(hours~humidity,data=bread)

interaction.plot(humidity,environment,hours)
interaction.plot(environment,humidity,hours)
```

### Task 3

```{r}
# Add Code
```

### Task 4

```{r}
# Add Code
```

### Task 5

```{r}
# Add Code
```

## Exercise 2
Exercise 2
```{r}
search=read.table("search.txt",header = TRUE);
attach(search)
```

### Task 1 MISSING!

```{r}
# Add Code
```

### Task 2

```{r}
interaction.plot(skill,interface,time)
interaction.plot(interface,skill,time)
```

The lines do not seem parallel. Therefore, we can say that there is interaction between interface and skill.

### Task 3
We consider the variables as factors because they are numbers. Then, we perform a 2-way anova test.
```{r,results="hide"}
search$skill = as.factor(search$skill)
search$interface = as.factor(search$interface)

searchaov = lm(time~interface+skill,data=search)
anova(searchaov)
```
We get a p-value for interface of `r anova(searchaov)[[5]][1]`. Which indicates that we can reject that the mean of the interfaces are the same.
### Task 4
We load the library multcom in order to be able to make multiple comparison. Then we perform the analysis.

```{r,results="hide"}
library(multcomp)
searchaov2 = lm(time~interface+skill,data=search)

searchmult = glht(searchaov2,linfct=mcp(skill="Tukey"))
summary(searchmult)
```
According to the test 4 - 3 == 0 has an estimate of 2.267.
That's the estimate time for a user of skill 4 with the interface 3.
### Task 5

```{r}
qqnorm(residuals(searchaov2))
qqline(residuals(searchaov2))
```
The QQ-plot seems a bit deviated in the extremes but it could be normal.
```{r}
plot(fitted(searchaov2),residuals(searchaov2))
```

We see that the residuals don't change systematically with the fitted values.
So we can assume that the populations have equal variances.
### Task 6

We perform the Friedman test.
```{r}
friedman.test(search$time,search$interface,search$skill)
```
We reject H0 (Interface doesn't have an effect) so we can say that the interface makes an effect.

### Task 7
we perform the one-way anova test.

```{r,result="hide"}
search$interface = as.factor(search$interface)

searchaov = lm(time~interface,data=search)

anova(searchaov)
```

We get p-value of `ranova(searchaov)[[5]][1]` so we cannot reject that the means are the same for the different interfaces.
It is not useful because the variable skill should also be considered since according to the interaction plots there is interaction between skill and interface.

1-way-anova assumes that the data come from normal population and the variances are equal
```{r}
qqnorm(residuals(searchaov))
qqline(residuals(searchaov))
```
The population doesn't seem normal therefore the assumption is not met.

## Exercise 3
Exercise 3
```{r}
# Add Code
```

### Task 1

```{r}
# Add Code
```

### Task 2

```{r}
# Add Code
```

### Task 3

```{r}
# Add Code
```

### Task 4

```{r}
# Add Code
```

## Exercise 4
Exercise 4
```{r}
# Add Code
```

### Task 1

```{r}
# Add Code
```

### Task 2

```{r}
# Add Code
```

### Task 3

```{r}
# Add Code
```

### Task 4

```{r}
# Add Code
```

## Exercise 5
Exercise 5
```{r}
# Add Code
```
### Task 1

```{r}
# Add Code
```

### Task 2

```{r}
# Add Code
```

### Task 3

```{r}
# Add Code
```

### Task 4

```{r}
# Add Code
```

## Exercise 6
Exercise 6
```{r}
# Add Code
```

### Task 1

```{r}
# Add Code
```

### Task 2

```{r}
# Add Code
```

### Task 3

```{r}
# Add Code
```

### Task 4

```{r}
# Add Code
```

### Task 5

```{r}
# Add Code
```

## Exercise 7
Exercise 7
```{r}
# Add Code
```

### Task a

```{r}
# Add Code
```

### Task b

```{r}
# Add Code
```

### Task c

```{r}
# Add Code
```

