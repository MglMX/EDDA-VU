---
title: "Assignment 3"
author: "Tanjina Islam, Miguel Morales Expósito and Carlos Perales Liñan, group 12"
date: "13 March 2018"
output:
  pdf_document:
    fig_caption: yes
fontsize: 11pt
highlight: tango
---
```{r,echo=FALSE}
options(digits = 3) #Showing only 3 decimals
library(multcomp)
library(lme4)
```

## Exercise 4

First, we load the data from the data source.
```{r, results='hide'}
cows = read.table("cow.txt", header = TRUE)
```

### Task 1

```{r, results='hide'}
cows$id=factor(cows$id)
cows$per=factor(cows$per)
cowslm=lm(milk~treatment+per+id,data=cows)

```
```{r}
summary(cowslm)[[4]]
```


As we can see in the p-values [`r summary(cowslm)[[4]][[35]]`] of the treatment, we can see that it is higher than 0.05. Thus, we cannot reject the hypothesis that treatment doesn't have any main effect on milk production.



### Task 2

```{r, results='hide'}
milkdif =glht(cowslm,linfct=mcp(treatment="Tukey")) 
```
We can see that the estimate of B-A is [`r summary(milkdif)[[10]][[3]][[1]]`]. In addition to this, we see thatthe p-value is [`r summary(milkdif)[[10]][[6]][[1]]`].

With this, we can't reject that the difference in milk production with treatment A is equal to the one using treatment B.


### Task 3

#### Checking influence in milk production

```{r, results='hide'}
cowslmer=lmer(milk~treatment+order+per+(1|id),data=cows,REML=FALSE)
cowslmer1=lmer(milk~order+per+(1|id),data=cows,REML=FALSE)
anova(cowslmer1,cowslmer)

```
As we can see in the p-values [`r anova(cowslmer1,cowslmer)[[8]][2]`] of the tratment, we can see that it is higher than 0.05. Thus, we cannot reject the hypothesis that treatment doesn't have any main effect on milk production.

#### Estimating the difference

```{r, results='hide'}
milkdiflmer =glht(cowslmer,linfct=mcp(treatment="Tukey")) 
```
We can see that the estimate of B-A is [`r summary(milkdiflmer)[[10]][[3]][[1]]`]. In addition to this, we see that the p-value is [`r summary(milkdiflmer)[[10]][[6]][[1]]`].

With this, we can't reject that the difference in milk production with treatment A is equal to the one using treatment B.


### Task 4

The following command performs a t-test of the milk production using treatment a and milk production using treatment B. The test will help us say if the difference between these is 0 or not.

```{r, results='hide'}
attach(cows)
t.test(milk[treatment=="A"],milk[treatment=="B"],paired=TRUE)
```
The t-test gives back the p-value [`r t.test(milk[treatment=="A"],milk[treatment=="B"],paired=TRUE)[[3]]`]. With this, we can't reject that the difference is = to 0.

This test does agree with the conclussion in task 1, where we concluded that the feeding treatment didn't have main influence in the milk production. Which is similar to saying that the difference of the means of milk production between both treatments is 0. Thus, we believe the test is valid to come to the same result
